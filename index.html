<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="UTF-8">
<title>Flipbook T∆∞ t∆∞·ªüng H·ªì Ch√≠ Minh</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
/* ===== N·ªÄN ===== */
body{
  margin:0;
  min-height:100vh;
  font-family:"Times New Roman", serif;

  background:#111 url("images/hcm.jpg") center center no-repeat fixed;
  background-size:contain;

  display:flex;
  justify-content:center;
  align-items:flex-start;
}

/* n·ªÅn m·ªù */
body::before{
  content:"";
  position:fixed;
  inset:0;
  background:rgba(0,0,0,.35);
  backdrop-filter: blur(10px);
  z-index:-1;
}

/* ===== S√ÅCH ===== */
.book{
  width:clamp(320px, 96vw, 640px);
  height:clamp(480px, 92vh, 900px);
  perspective:3500px;
  position:relative;
  margin-top:10px;
}

/* ===== T·ªú S√ÅCH ===== */
.sheet{
  position:absolute;
  inset:0;
  background:#fff;
  transform-origin:top center;
  transition:transform 1s ease;
  overflow:hidden;
}

.sheet.flipped{
  transform:rotateX(-180deg);
  pointer-events:none;
}

/* ===== 1 TRANG ===== */
.single img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
}

/* ===== 2 TRANG TR√äN‚ÄìD∆Ø·ªöI ===== */
.double{
  display:flex;
  flex-direction:column;
}

.double .page{
  height:50%;
  overflow:hidden;
}

/* √©p kh√≠t v·ª´a ƒë·ªß */
.double .page:first-child img{ margin-bottom:-4px; }
.double .page:last-child img{ margin-top:-4px; }

.double img{
  width:100%;
  height:100%;
  object-fit:contain;
  display:block;
}

/* ===== N√öT NH·∫†C ===== */
.music-btn{
  position:fixed;
  bottom:20px;
  right:20px;
  padding:10px 14px;
  border-radius:30px;
  border:1px solid rgba(255,255,255,.3);
  background:rgba(0,0,0,.6);
  color:#fff;
  cursor:pointer;
}
</style>
</head>

<body>

<div class="book" id="book"></div>

<button class="music-btn" id="musicBtn">üîá Nh·∫°c: T·∫Øt</button>

<audio id="bgm" loop>
  <source src="audio/bgm.mp3" type="audio/mpeg">
</audio>

<script>
const book = document.getElementById("book");
const sheets = [];
let current = 0;
let z = 1000;
let busy = false;

/* ===== T·∫†O TRANG ===== */
function singlePage(src, clickable=true){
  const s = document.createElement("div");
  s.className = "sheet single";
  s.style.zIndex = z--;
  s.innerHTML = `<img src="${src}">`;
  if(!clickable) s.style.pointerEvents="none";
  book.appendChild(s);
  sheets.push(s);
}

function doublePage(top,bottom){
  const s = document.createElement("div");
  s.className = "sheet double";
  s.style.zIndex = z--;
  s.innerHTML = `
    <div class="page"><img src="${top}"></div>
    <div class="page"><img src="${bottom}"></div>
  `;
  book.appendChild(s);
  sheets.push(s);
}

/* ===== L·∫¨T ===== */
function next(){
  if(busy || current >= sheets.length) return;
  busy = true;
  sheets[current].classList.add("flipped");
  current++;
  setTimeout(()=>busy=false,1000);
}

function prev(){
  if(busy || current <= 0) return;
  busy = true;
  current--;
  sheets[current].classList.remove("flipped");
  setTimeout(()=>busy=false,1000);
}

/* ===== VU·ªêT ===== */
let startY = 0;
let endY = 0;
const threshold = 50;

/* mobile */
book.addEventListener("touchstart", e=>{
  startY = e.touches[0].clientY;
});

book.addEventListener("touchend", e=>{
  endY = e.changedTouches[0].clientY;
  const diff = startY - endY;
  if(Math.abs(diff) < threshold || busy) return;
  diff > 0 ? next() : prev();
});

/* desktop */
book.addEventListener("wheel", e=>{
  if(busy) return;
  e.deltaY > 0 ? next() : prev();
},{passive:true});

/* ===== D·ª∞NG S√ÅCH ===== */
singlePage("images/cover.png");

for(let i=1;i<=32;i+=2){
  doublePage(`images/${i}.png`,`images/${i+1}.png`);
}

singlePage("images/back.png", false);

/* ===== NH·∫†C ===== */
const bgm = document.getElementById("bgm");
const btn = document.getElementById("musicBtn");
let playing=false;

btn.onclick=()=>{
  if(!playing){
    bgm.volume=0.4;
    bgm.play();
    btn.textContent="üîä Nh·∫°c: B·∫≠t";
  }else{
    bgm.pause();
    btn.textContent="üîá Nh·∫°c: T·∫Øt";
  }
  playing=!playing;
};
</script>

</body>
</html>
